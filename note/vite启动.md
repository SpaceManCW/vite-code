# Vite启动项目初体验

开箱即用：你不需要做任何额外的配置就可以使用vite来帮你处理构建工作

在默认情况下，我们esmodule去导入资源的时候，要么是绝对路径，要么是相对路径，直接：
```js
import _ from 'lodash'
```
浏览器是不知道项目下有node_modules的，不会去这里面找依赖

为什么es官方不默认寻找node_modules?
浏览器使用网络请求去请求依赖，依赖的依赖也会被请求，那就有可能请求非常多的资源，非常消耗性能

直接安转vite:
```js
yarn add vite
```

在package.json中添加完script之后，启动项目，执行：
```js
yarn dev
```

## Vite的预加载
```js
import _ from 'lodash'
```
在处理的过程中如果看到了有非绝对路径和相对路径的引用，Vite会开启路径补全，到node_modules中找
寻找依赖的过程是自当前目录以此向上查找的过程，直到搜寻到根目录或者搜寻到对应的依赖为止

生产和开发环境的区别：
yarn dev 开发环境每次依赖预构建所重新构建的相对路径都是正确的，而在生产环境vite则会将上面的工作全权交给rollup去完成生产环境的打包

有的包是以commonJS的规范导出的，而vite则不认识这种导出方式，通过依赖预构建解决：
首先vite会找到对应的依赖，然后调用esbuild(对js语法进行处理)，将其他规范的代码转换成esmodule规范，然后放在当前目录下的node_modules中。同时对esmodule的各个模块进行统一集成，解决了三个问题：
- 不同的第三方包会有不同的导出格式(这个是vite没法约束人家的事情)
- 对路径的处理上可以直接使用.vite/deps，方便路径重写
- 网络多包传输的性能问题，比如一个依赖依赖其他的文件则需要都请求一遍(这也是原生esmodule规范不敢支持node_modules的原因之一)

有了依赖预构建之后无论有多少个额外的import，vite都会尽可能的将他们进行集成，最后只生成一个或者多个模块

